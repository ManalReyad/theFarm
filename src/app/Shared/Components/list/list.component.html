<div
  class="listContainer p-1"
  *ngIf="
    (pageResult?.items && (pageResult?.items)!.length > 0) || displayEmptyList
  "
>
  <p-table
    [value]="pageResult?.items || []"
    [lazy]="true"
    [tableStyle]="{ 'min-width': '50rem'}"
    [class]="hasBorder ? 'custom-style' : ''"
  >
    <ng-template pTemplate="header">
      <tr>
        <th
          [class]="col.isIndex ? 'index' : 'text-center'"
          [ngClass]="col.headerCustomStyle ? col.headerCustomStyle : ''"
          *ngFor="let col of listColumns | hideColumn"
          pReorderableColumn
        >
          {{ col.header }}
        </th>
        <th
          [ngClass]="'text-center'"
          *ngIf="withAction"
          style="width: 10%; min-width: 5rem"
        >
          إعدادات
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-entity let-i="rowIndex">
      <tr [pReorderableRow]="i">
        <td
          *ngFor="let col of listColumns"
          class="'justify-center"
          [class]="col.isIndex ? 'index' : 'justify-center'"
          [style]="
            'width:' +
            col.width +
            '%; min-width:' +
            (col.minWidth ? (col.minWidth > 0 ? col.minWidth : '10') : '') +
            'rem; '
          "
        >
          <span class="p-column-title">{{ entity[col.header] }}</span>
          <span class="">
            <span *ngIf="col.isIndex">
              {{ i + 1 }}
            </span>

            <span *ngIf="col.isToggle">
              <p-inputSwitch
                [(ngModel)]="entity[col.field]"
                (onChange)="changeStatus($event, entity)"
              ></p-inputSwitch>
            </span>
            <span
              *ngIf="
                !col.isDate &&
                !col.isCurrancy &&
                !col.isProjectType &&
                !col.isColor &&
                !col.coloredCol &&
                !col.percentage &&
                !col.isIndex &&
                !col.isToggle &&
                !col.isObject
              "
              class="mx-1"
              [class]="
                col.statusClass +
                ' status-' +
                entity[col?.statusBadgeField ?? '']
              "
            >
              <span pReorderableRowHandle *ngIf="col.isOrder">
                <i class="fa-solid fa-ellipsis-vertical mx-1"></i>
                <i class="fa-solid fa-ellipsis-vertical"></i>
                <span class="mx-2"> {{ entity[col.field] }} </span>
              </span>
              <span *ngIf="!col.isOrder && !col.toolTip">
                {{ entity[col.field] }}</span
              >
              <span *ngIf="!col.isOrder && entity[col.field]?.length<40&&entity[col.toolTip]">
                {{ entity[col.field] }}</span
              >
              <span *ngIf="entity[col.field]?.length>40&&entity[col.toolTip]" [pTooltip]="entity[col.toolTip]">
                {{ entity[col.field] }}</span
              >
            </span>

            <span *ngIf="col.isObject">
              {{ col.objectName ? entity[col.objectName][col.field] : "" }}
            </span>

            <span *ngIf="col.isDate">
              {{ entity[col.field] | date }}
            </span>
            <span *ngIf="col.coloredCol" class="coloredCol">
              {{ entity[col.field] }}
            </span>

            <span *ngIf="col.percentage" class="coloredCol">
              {{ entity[col.field] }} %
            </span>
            <span *ngIf="col.isCurrancy">
              {{ entity[col.field] | currency : " " : "symbol" : "0.0-1" }}
            </span>
          </span>
        </td>
        <td *ngIf="withAction" class="flex justify-center items-center gap-3">
          <span *ngIf="hasEdit" (click)="onEdit(entity, i)">
            <img
              class="cursor-pointer"
              src="../../../../assets/images/edit.svg"
              alt="edit icon"
            />
          </span>
          <span *ngIf="hasDelete" (click)="onDelete(entity, i)">
            <img
              class="cursor-pointer"
              src="../../../../assets/images/delete.svg"
              alt="delete icon"
            />
          </span>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
<div class="pagination" *ngIf="pageResult?.items?.length != 0 && hasPagination">
  <p-paginator
    (onPageChange)="onPageChange($event)"
    [first]="first"
    [rows]="rows"
    [totalRecords]="pageResult?.records"
    [showCurrentPageReport]="false"
    [pageLinkSize]="3"
  ></p-paginator>
  <div class="nestedDiv">
    <span class="spanText"> عرض </span>
    <p-dropdown
      [options]="options"
      optionLabel="name"
      optionValue="id"
      [(ngModel)]="rows"
      (onChange)="onPageChange({ page: 1, first: 0, rows: rows })"
    ></p-dropdown>

    <span class="spanText"> من العناصر </span>
  </div>
</div>

<div
  class="noDataSection"
  *ngIf="
    pageResult?.items &&
    pageResult?.items?.length == 0 &&
    !searchMode &&!filterMode&&
    !displayEmptyList
  "
>
  <app-no-data
    [noDataImg]="noDataImg"
    [noDataMessage]="noDataMessage"
  ></app-no-data>
  <button (click)="addNew()">
    <span>{{ addButtonText }} </span>
  </button>
</div>
<div
  class="noDataSection"
  *ngIf="pageResult?.items && pageResult?.items?.length == 0 && (searchMode||filterMode)"
>
  <img src="../../../../assets/images/noSearchData.svg" alt="" />
  <p class="text-xl text-gray-500 mt-3">
    يبدو أنه لا تتوفر نتائج لبحثك، من فضلك حاول مرة أخرى...
  </p>
  <button (click)="onBack()">
    <span>{{ nosearchBtnText }} </span>
  </button>
</div>
